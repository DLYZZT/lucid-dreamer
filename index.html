<!DOCTYPE html>
<html lang="zh">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ‰‹åŠ¿æ§åˆ¶ç²’å­ç³»ç»Ÿ</title>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: #000;
            font-family: 'Segoe UI', sans-serif;
        }

        canvas {
            display: block;
        }

        /* éšè—æ‘„åƒå¤´åŸå§‹è§†é¢‘æµ */
        #video-input {
            visibility: hidden;
            position: absolute;
            width: 1px;
            height: 1px;
            top: 0;
            left: 0;
            z-index: -1;
        }

        /* UI å®¹å™¨ - ç»ç’ƒæ‹Ÿæ€ */
        #ui-container {
            position: absolute;
            top: 75px;
            right: 20px;
            width: 280px;
            padding: 20px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            z-index: 10;
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            box-shadow: 0 4px 30px rgba(0, 0, 0, 0.5);
            transition: opacity 0.3s, transform 0.3s;
            transform-origin: top right;
        }

        #ui-container.hidden {
            opacity: 0;
            pointer-events: none;
            transform: scale(0.95);
        }

        #toggle-btn {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 44px;
            height: 44px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 20;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
        }

        #toggle-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        #github-btn {
            position: absolute;
            top: 20px;
            right: 74px;
            /* 20px (right) + 44px (width) + 10px (gap) */
            width: 44px;
            height: 44px;
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            color: white;
            font-size: 20px;
            cursor: pointer;
            z-index: 20;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: 0.3s;
            text-decoration: none;
        }

        #github-btn:hover {
            background: rgba(255, 255, 255, 0.2);
            transform: scale(1.1);
        }

        h2 {
            margin: 0 0 15px 0;
            font-size: 18px;
            letter-spacing: 1px;
            text-transform: uppercase;
        }

        .control-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-size: 12px;
            color: #aaa;
        }

        /* è‡ªå®šä¹‰é€‰æ‹©å™¨ */
        select,
        input[type="color"] {
            width: 100%;
            padding: 8px;
            background: rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.3);
            border-radius: 8px;
            color: white;
            outline: none;
            cursor: pointer;
        }

        /* çŠ¶æ€æŒ‡ç¤ºç¯ */
        #status {
            font-size: 12px;
            margin-top: 10px;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: #ff4444;
        }

        .dot.active {
            background-color: #00ff88;
            box-shadow: 0 0 8px #00ff88;
        }

        /* å…¨å±æŒ‰é’® */
        #fullscreen-btn {
            position: absolute;
            bottom: 20px;
            right: 20px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
            cursor: pointer;
            backdrop-filter: blur(5px);
            transition: 0.3s;
        }

        #fullscreen-btn:hover {
            background: rgba(255, 255, 255, 0.2);
        }

        #loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: white;
            font-size: 24px;
            pointer-events: none;
            text-align: center;
        }

        /* ç§»åŠ¨ç«¯é€‚é… */
        @media (max-width: 768px) {
            #ui-container {
                width: auto;
                left: 20px;
                right: 20px;
                top: auto;
                bottom: 80px;
                max-height: 40vh;
                overflow-y: auto;
                padding: 15px;
                transform-origin: bottom center;
            }

            #ui-container.hidden {
                transform: translateY(20px) scale(0.95);
            }

            h2 {
                font-size: 16px;
                margin-bottom: 10px;
            }

            .control-group {
                margin-bottom: 10px;
            }

            #fullscreen-btn {
                width: calc(100% - 40px);
                left: 20px;
                right: 20px;
                bottom: 20px;
                text-align: center;
                padding: 12px;
            }
        }
    </style>
</head>

<body>

    <div id="loading">æ­£åœ¨åŠ è½½æ¨¡å‹ä¸æ‘„åƒå¤´...<br><span style="font-size:14px; opacity:0.7">è¯·å…è®¸æ‘„åƒå¤´æƒé™</span></div>
    <video id="video-input" playsinline webkit-playsinline></video>



    <a id="github-btn" href="https://github.com/DLYZZT/lucid-dreamer" target="_blank" title="View on GitHub">
        <svg height="24" width="24" viewBox="0 0 16 16" fill="white">
            <path
                d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38A8.013 8.013 0 0016 8c0-4.42-3.58-8-8-8z">
            </path>
        </svg>
    </a>

    <button id="toggle-btn">âš™ï¸</button>

    <div id="ui-container">
        <h2>ç²’å­æ§åˆ¶å™¨</h2>

        <div class="control-group">
            <label>é€‰æ‹©æ¨¡å‹ (Model)</label>
            <select id="shape-select">
                <option value="heart">ğŸ’– ç ´ç¢ä¹‹å¿ƒ (Heart)</option>
                <option value="saturn">ğŸª åœŸæ˜Ÿå…‰ç¯ (Saturn)</option>
                <option value="lotus">ğŸŒ¸ è²èŠ± (Lotus)</option>
                <option value="fireworks">ğŸ† çƒŸèŠ±çˆ†ç‚¸ (Fireworks)</option>
                <option value="sphere">ğŸ”® åŸºç¡€çƒä½“ (Sphere)</option>
            </select>
        </div>

        <div class="control-group">
            <label>ç²’å­é¢œè‰² (Base Color)</label>
            <input type="color" id="color-picker" value="#ff0055">
        </div>

        <div class="control-group">
            <label>å½“å‰æ‰‹åŠ¿çŠ¶æ€</label>
            <div id="hand-status" style="font-size: 12px; color: #00ff88;">ç­‰å¾…æ‰‹åŠ¿...</div>
        </div>

        <div id="status">
            <div class="dot" id="cam-dot"></div>
            <span id="cam-text">æ‘„åƒå¤´æœªå°±ç»ª</span>
        </div>
    </div>

    <button id="fullscreen-btn">â›¶ å…¨å±ä½“éªŒ</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/hands/hands.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@mediapipe/camera_utils/camera_utils.js"></script>

    <script>
        // --- 1. åˆå§‹åŒ– Three.js åœºæ™¯ ---
        const scene = new THREE.Scene();
        // æ·»åŠ ä¸€ç‚¹è¿·é›¾å¢å¼ºæ™¯æ·±æ„Ÿ
        scene.fog = new THREE.FogExp2(0x000000, 0.002);

        const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
        camera.position.z = 30;

        const renderer = new THREE.WebGLRenderer({ antialias: true, alpha: true });
        renderer.setSize(window.innerWidth, window.innerHeight);
        renderer.setPixelRatio(window.devicePixelRatio);
        document.body.appendChild(renderer.domElement);

        // --- 2. ç²’å­ç³»ç»Ÿæ ¸å¿ƒé€»è¾‘ ---
        const PARTICLE_COUNT = 15000;
        const geometry = new THREE.BufferGeometry();
        const positions = new Float32Array(PARTICLE_COUNT * 3);
        const targetPositions = new Float32Array(PARTICLE_COUNT * 3);
        // å­˜å‚¨æ¯ä¸ªç²’å­çš„éšæœºé€Ÿåº¦ï¼Œç”¨äºçƒŸèŠ±æˆ–è‡ªç„¶è¿åŠ¨
        const velocities = new Float32Array(PARTICLE_COUNT * 3);

        // åˆå§‹åŒ–æ‰€æœ‰ç²’å­åœ¨åŸç‚¹
        for (let i = 0; i < PARTICLE_COUNT * 3; i++) {
            positions[i] = (Math.random() - 0.5) * 100;
            targetPositions[i] = 0;
            velocities[i] = (Math.random() - 0.5) * 0.2;
        }

        geometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));

        // åˆ›å»ºæè´¨
        const material = new THREE.PointsMaterial({
            size: 0.15,
            color: 0xff0055,
            transparent: true,
            opacity: 0.8,
            blending: THREE.AdditiveBlending,
            depthWrite: false
        });

        const particleSystem = new THREE.Points(geometry, material);
        scene.add(particleSystem);

        // --- 3. æ•°å­¦æ¨¡å‹ç”Ÿæˆå™¨ ---

        function getPointOnSphere() {
            const u = Math.random();
            const v = Math.random();
            const theta = 2 * Math.PI * u;
            const phi = Math.acos(2 * v - 1);
            const r = 10;
            return {
                x: r * Math.sin(phi) * Math.cos(theta),
                y: r * Math.sin(phi) * Math.sin(theta),
                z: r * Math.cos(phi)
            };
        }

        // ç”Ÿæˆä¸åŒå½¢çŠ¶çš„ç›®æ ‡ç‚¹
        function generateShape(type) {
            const scale = 1.5;
            for (let i = 0; i < PARTICLE_COUNT; i++) {
                let x, y, z;
                const idx = i * 3;

                if (type === 'heart') {
                    // çˆ±å¿ƒå‚æ•°æ–¹ç¨‹
                    // x = 16sin^3(t)
                    // y = 13cos(t) - 5cos(2t) - 2cos(3t) - cos(4t)
                    const t = Math.random() * Math.PI * 2;
                    // ç¨å¾®æ‰“ä¹±ä¸€ç‚¹tå’Œæ·»åŠ ä¸€ç‚¹ä½“ç§¯æ„Ÿ
                    const r = Math.random(); // å†…éƒ¨å¡«å……
                    x = 16 * Math.pow(Math.sin(t), 3);
                    y = 13 * Math.cos(t) - 5 * Math.cos(2 * t) - 2 * Math.cos(3 * t) - Math.cos(4 * t);
                    z = (Math.random() - 0.5) * 4; // åšåº¦

                    // å½’ä¸€åŒ–å¹¶ç¼©æ”¾
                    x *= 0.5 * scale;
                    y *= 0.5 * scale;
                    z *= scale;

                } else if (type === 'saturn') {
                    // åœŸæ˜Ÿï¼šçƒä½“ + ç¯
                    if (i < PARTICLE_COUNT * 0.4) {
                        // æ˜Ÿçƒæœ¬ä½“
                        const p = getPointOnSphere();
                        x = p.x * 0.6; y = p.y * 0.6; z = p.z * 0.6;
                    } else {
                        // å…‰ç¯ (åœ†å½¢å¹³é¢)
                        const angle = Math.random() * Math.PI * 2;
                        const dist = 9 + Math.random() * 6; // ç¯çš„åŠå¾„èŒƒå›´
                        x = Math.cos(angle) * dist;
                        z = Math.sin(angle) * dist;
                        y = (Math.random() - 0.5) * 0.5; // ç¯éå¸¸è–„

                        // å€¾æ–œç¯
                        const tilt = 0.4;
                        const tempY = y * Math.cos(tilt) - z * Math.sin(tilt);
                        const tempZ = y * Math.sin(tilt) + z * Math.cos(tilt);
                        y = tempY; z = tempZ;
                    }

                } else if (type === 'lotus') {
                    // è²èŠ±/ä½›ç³»æ„è±¡ (æåæ ‡ç«ç‘°çº¿ + å‚ç›´åˆ†å¸ƒ)
                    const u = Math.random() * Math.PI * 2;
                    const v = Math.random() * Math.PI;
                    // èŠ±ç“£æ–¹ç¨‹æ¨¡æ‹Ÿ
                    const petals = 6;
                    const r = 5 + 5 * Math.sin(petals * u) * Math.sin(v);

                    x = r * Math.sin(v) * Math.cos(u);
                    z = r * Math.sin(v) * Math.sin(u);
                    y = r * Math.cos(v) + 5; // å‘ä¸Šæä¸€ç‚¹

                    // åŠ ä¸ªåº•åº§
                    if (i > PARTICLE_COUNT * 0.8) {
                        const angle = Math.random() * Math.PI * 2;
                        const diskR = Math.random() * 8;
                        x = Math.cos(angle) * diskR;
                        z = Math.sin(angle) * diskR;
                        y = -2 + (Math.random() * 1);
                    }

                } else if (type === 'fireworks') {
                    // çƒŸèŠ±ï¼šåªæ˜¯ä¸€ä¸ªä¸­å¿ƒç‚¹ï¼Œä½†åœ¨åŠ¨ç”»å¾ªç¯ä¸­æˆ‘ä»¬ä¼šè®©å®ƒç‚¸å¼€
                    // è¿™é‡Œæˆ‘ä»¬è®¾ç½®ç›®æ ‡ä½ç½®ä¸ºçƒä½“ï¼Œä½†åœ¨åŠ¨ç”»é€»è¾‘ä¸­ä¼šç‰¹æ®Šå¤„ç†
                    const p = getPointOnSphere();
                    x = p.x * 2; y = p.y * 2; z = p.z * 2;
                } else {
                    // é»˜è®¤çƒä½“
                    const p = getPointOnSphere();
                    x = p.x; y = p.y; z = p.z;
                }

                targetPositions[idx] = x;
                targetPositions[idx + 1] = y;
                targetPositions[idx + 2] = z;
            }
        }

        // åˆå§‹ç”Ÿæˆçˆ±å¿ƒ
        generateShape('heart');

        // --- 4. äº¤äº’çŠ¶æ€ç®¡ç† ---
        const state = {
            handDistance: 0, // 0 = åªæœ‰ä¸€åªæ‰‹æˆ–æ‰‹å¾ˆè¿œ, 1 = æ‰‹å¾ˆè¿‘
            isHandsDetected: false,
            dispersion: 0, // æ‰©æ•£ç¨‹åº¦
            currentShape: 'heart'
        };

        // --- 5. MediaPipe Hands è®¾ç½® ---
        const videoElement = document.getElementById('video-input');
        const canvasElement = renderer.domElement;
        const statusDot = document.getElementById('cam-dot');
        const statusText = document.getElementById('cam-text');
        const handStatusText = document.getElementById('hand-status');
        const loadingDiv = document.getElementById('loading');

        function onResults(results) {
            loadingDiv.style.display = 'none';
            statusDot.classList.add('active');
            statusText.innerText = "æ‘„åƒå¤´è¿è¡Œä¸­";

            if (results.multiHandLandmarks && results.multiHandLandmarks.length >= 2) {
                // æ£€æµ‹åˆ°ä¸¤åªæ‰‹
                state.isHandsDetected = true;

                // è·å–ä¸¤åªæ‰‹é£ŸæŒ‡æŒ‡å°– (Index Finger Tip æ˜¯ç´¢å¼• 8)
                const hand1 = results.multiHandLandmarks[0][8];
                const hand2 = results.multiHandLandmarks[1][8];

                // è®¡ç®—ä¸¤æ‰‹ä¹‹é—´çš„æ¬§å‡ é‡Œå¾—è·ç¦» (ç®€å•å¹³é¢è·ç¦»)
                const dx = hand1.x - hand2.x;
                const dy = hand1.y - hand2.y;
                // dz å¿½ç•¥ï¼Œå› ä¸ºæ·±åº¦ä¼°ç®—ä¸ç¨³å®š
                const distance = Math.sqrt(dx * dx + dy * dy);

                // è·ç¦»æ˜ å°„ï¼š
                // è·ç¦»é€šå¸¸åœ¨ 0.05 (é å¾ˆè¿‘) åˆ° 0.8 (å¾ˆè¿œ) ä¹‹é—´
                // æˆ‘ä»¬å¸Œæœ›ï¼šè·ç¦»è¿‘ -> å®Œç¾æ¨¡å‹ï¼›è·ç¦»è¿œ -> ç‚¸å¼€

                // æ ‡å‡†åŒ–è·ç¦»ï¼š0 (Close) to 1 (Far)
                let normalizedDist = (distance - 0.1) * 2.0;
                normalizedDist = Math.max(0, Math.min(1, normalizedDist));

                state.dispersion = normalizedDist * 20; // æ”¾å¤§ç³»æ•°
                state.handDistance = distance;

                handStatusText.innerText = `æ£€æµ‹åˆ°åŒæ‰‹ | è·ç¦»: ${distance.toFixed(2)}`;
            } else if (results.multiHandLandmarks.length === 1) {
                // å•æ‰‹æ¨¡å¼ï¼šæ£€æµ‹é£ŸæŒ‡å’Œæ‹‡æŒ‡æåˆ (ç´¢å¼• 8 å’Œ 4)
                state.isHandsDetected = true;
                const hand = results.multiHandLandmarks[0];
                const dx = hand[8].x - hand[4].x;
                const dy = hand[8].y - hand[4].y;
                const dist = Math.sqrt(dx * dx + dy * dy);

                // æåˆ = 0.02 (å°), å¼ å¼€ = 0.2 (å¤§)
                let pinch = (dist - 0.03) * 8.0;
                pinch = Math.max(0, Math.min(1, pinch));

                state.dispersion = pinch * 15;
                handStatusText.innerText = `å•æ‰‹æåˆæ§åˆ¶ | å¼ å¼€åº¦: ${dist.toFixed(2)}`;
            } else {
                state.isHandsDetected = false;
                // æ²¡æ‰‹çš„æ—¶å€™ï¼Œè‡ªåŠ¨å‘¼å¸æ•ˆæœ
                handStatusText.innerText = "æœªæ£€æµ‹åˆ°æ‰‹åŠ¿ - è‡ªåŠ¨æ¼”ç¤ºæ¨¡å¼";
            }
        }

        const hands = new Hands({
            locateFile: (file) => {
                return `https://cdn.jsdelivr.net/npm/@mediapipe/hands/${file}`;
            }
        });

        const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        hands.setOptions({
            maxNumHands: 2,
            modelComplexity: isMobile ? 0 : 1, // ç§»åŠ¨ç«¯ä½¿ç”¨è½»é‡çº§æ¨¡å‹
            minDetectionConfidence: 0.5,
            minTrackingConfidence: 0.5
        });

        hands.onResults(onResults);

        const cameraUtils = new Camera(videoElement, {
            onFrame: async () => {
                await hands.send({ image: videoElement });
            },
            width: isMobile ? 360 : 640, // ç§»åŠ¨ç«¯é™ä½åˆ†è¾¨ç‡ä»¥æé«˜æ€§èƒ½
            height: isMobile ? 270 : 480,
            facingMode: 'user' // ä¼˜å…ˆä½¿ç”¨å‰ç½®æ‘„åƒå¤´
        });
        cameraUtils.start();

        // --- 6. åŠ¨ç”»å¾ªç¯ ---
        const clock = new THREE.Clock();

        function animate() {
            requestAnimationFrame(animate);

            const time = clock.getElapsedTime();
            const delta = clock.getDelta(); // è™½ç„¶ä¸Šé¢æ²¡ç”¨ï¼Œä½†åœ¨ç‰©ç†è®¡ç®—å¥½ä¹ æƒ¯

            // ç²’å­è¿åŠ¨é€»è¾‘
            const positionsArr = geometry.attributes.position.array;

            // ç¡®å®šå½“å‰çš„æ‰©æ•£å› å­
            let targetDispersion = 0;
            if (state.isHandsDetected) {
                targetDispersion = state.dispersion;
            } else {
                // è‡ªåŠ¨æ¨¡å¼ï¼šå‘¼å¸æ•ˆæœ
                targetDispersion = Math.sin(time) * 5 + 5;
            }

            // æ—‹è½¬æ•´ä¸ªç³»ç»Ÿ
            particleSystem.rotation.y += 0.002;

            for (let i = 0; i < PARTICLE_COUNT; i++) {
                const idx = i * 3;

                // åŸå§‹ç›®æ ‡ä½ç½®
                const tx = targetPositions[idx];
                const ty = targetPositions[idx + 1];
                const tz = targetPositions[idx + 2];

                // è®¡ç®—å½“å‰ä½ç½®
                let cx = positionsArr[idx];
                let cy = positionsArr[idx + 1];
                let cz = positionsArr[idx + 2];

                // æ ¸å¿ƒäº¤äº’ï¼šæ ¹æ® targetDispersion ä¿®æ”¹ç›®æ ‡ç‚¹
                // è¶Šæ‰©æ•£ï¼Œç›®æ ‡ç‚¹ç¦»åŸç‚¹è¶Šè¿œï¼Œä¸”åŠ æ‚ä¹±
                const noiseX = (Math.random() - 0.5) * targetDispersion * 2;
                const noiseY = (Math.random() - 0.5) * targetDispersion * 2;
                const noiseZ = (Math.random() - 0.5) * targetDispersion * 2;

                const expansion = 1 + (targetDispersion * 0.5);

                const destX = tx * expansion + noiseX;
                const destY = ty * expansion + noiseY;
                const destZ = tz * expansion + noiseZ;

                // çº¿æ€§æ’å€¼ (Lerp) å¹³æ»‘è¿‡æ¸¡
                const speed = 0.08; // å“åº”é€Ÿåº¦
                positionsArr[idx] += (destX - cx) * speed;
                positionsArr[idx + 1] += (destY - cy) * speed;
                positionsArr[idx + 2] += (destZ - cz) * speed;

                // ç‰¹æ®Šå¤„ç†ï¼šå¦‚æœæ˜¯çƒŸèŠ±ä¸”å¤„äºæ‰©æ•£çŠ¶æ€ï¼Œæ·»åŠ é‡åŠ›æ•ˆæœ
                if (state.currentShape === 'fireworks' && targetDispersion > 5) {
                    positionsArr[idx + 1] -= 0.1; // é‡åŠ›ä¸‹å 
                }
            }

            geometry.attributes.position.needsUpdate = true;
            renderer.render(scene, camera);
        }

        animate();

        // --- 7. UI äº‹ä»¶ç›‘å¬ ---

        // å½¢çŠ¶åˆ‡æ¢
        document.getElementById('shape-select').addEventListener('change', (e) => {
            state.currentShape = e.target.value;
            generateShape(e.target.value);
        });

        // é¢œè‰²åˆ‡æ¢
        document.getElementById('color-picker').addEventListener('input', (e) => {
            particleSystem.material.color.set(e.target.value);
        });

        // èœå•åˆ‡æ¢
        const uiContainer = document.getElementById('ui-container');
        document.getElementById('toggle-btn').addEventListener('click', () => {
            uiContainer.classList.toggle('hidden');
        });

        document.getElementById('fullscreen-btn').addEventListener('click', () => {
            const doc = window.document;
            const docEl = doc.documentElement;

            const requestFullScreen = docEl.requestFullscreen || docEl.mozRequestFullScreen || docEl.webkitRequestFullScreen || docEl.msRequestFullscreen;
            const cancelFullScreen = doc.exitFullscreen || doc.mozCancelFullScreen || doc.webkitExitFullscreen || doc.msExitFullscreen;

            if (!doc.fullscreenElement && !doc.mozFullScreenElement && !doc.webkitFullscreenElement && !doc.msFullscreenElement) {
                if (requestFullScreen) {
                    requestFullScreen.call(docEl);
                } else {
                    alert("æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒå…¨å± API (iOS Safari è¯·å°è¯•æ·»åŠ åˆ°ä¸»å±å¹•ä½¿ç”¨)");
                }
            } else {
                if (cancelFullScreen) {
                    cancelFullScreen.call(doc);
                }
            }
        });

        // çª—å£å¤§å°è‡ªé€‚åº”
        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

    </script>
</body>

</html>